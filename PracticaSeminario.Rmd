---
title: Seminario de Fuentes de datos biomédicas y web semántica
author:    | 
 | **David Sainz Gonzalo**
 | *[email](mailto:dsg1003@alu.ubu.es)*
 | **Diego Trascasa García**
 | *[email](mailto:dtg1003@alu.ubu.es)*
date: "5º Semestre / Curso 2022-2023"
output:
  html_document:
    df_print: paged
  pdf_document: 
    toc: yes
always_allow_html: true
---

# EFECTO DE LA CALIDAD DE AIRE EN DISTINTAS ENFERMEDADES

##Importación de los datos de Enfermedades.
Lo primero que realizamos es la importación de los datos de las enfermedades, lo hacemos a través de un archivo csv.

```{r Datos de Enfermedades}
library(readr)
X49971 <- read_delim("input/data/Enfermedades/49971.csv", 
    delim = "\t", escape_double = FALSE, 
    trim_ws = TRUE)
View(X49971)
```
Con el bloque de codigo anterior obtenemos una tabla con 7 columnas: 
Nacional, Comunidades y ciudades autónomas, Causa de Muerte, Sexo, Lugar de Ocurrencia, Año y Total. 
Obtemos un total de 214,200 entradas.
Esta tabla no va a ser necesario modificarla para su posterior comparación.


##Importación de los datos de Calidad de aire.

En este caso vamos a importar los datos de Calidad del aire de forma separada, se encuentran en varias tablas dependiendo del año y las magnitudes de calidad.

Comenzaremos con el año 2020:

```{r}
library(readr)
As_DD_2021 <- read_delim("input/data/calidad del aire/2020/As_DD_2021.csv", 
    delim = ";", escape_double = FALSE, trim_ws = TRUE)
View(As_DD_2021)

library(readr)
BaP_DD_2021 <- read_delim("input/data/calidad del aire/2020/BaP_DD_2021.csv", 
    delim = ";", escape_double = FALSE, trim_ws = TRUE)
View(BaP_DD_2021)

library(readr)
Cd_DD_2021 <- read_delim("input/data/calidad del aire/2020/Cd_DD_2021.csv", 
    delim = ";", escape_double = FALSE, trim_ws = TRUE)
View(Cd_DD_2021)

library(readr)
Ni_DD_2021 <- read_delim("input/data/calidad del aire/2020/Ni_DD_2021.csv", 
    delim = ";", escape_double = FALSE, trim_ws = TRUE)
View(Ni_DD_2021)

library(readr)
Pb_DD_2021 <- read_delim("input/data/calidad del aire/2020/Pb_DD_2021.csv", 
    delim = ";", escape_double = FALSE, trim_ws = TRUE)
View(Pb_DD_2021)

library(readr)
PM10_DD_2021 <- read_delim("input/data/calidad del aire/2020/PM10_DD_2021.csv", 
    delim = ";", escape_double = FALSE, trim_ws = TRUE)
View(PM10_DD_2021)

library(readr)
PM25_DD_2021 <- read_delim("input/data/calidad del aire/2020/PM25_DD_2021.csv", 
    delim = ";", escape_double = FALSE, trim_ws = TRUE)
View(PM25_DD_2021)
```

Ahora tenemos que modificar la tabla para conseguir tratar los datos.

```{r}
##ARSENICO
tabla <- select(.data = As_DD_2021, PROVINCIA, ANNO, D01:D31 )

tabla <-rename(.data = tabla, AÑO = ANNO)

tab <- tabla %>%
  group_by(PROVINCIA,AÑO) %>%
  summarise(across(c(D01:D31), ~ mean(.x, na.rm = TRUE)))

tab$ARSENICO <- apply(tab[ ,c(3:33)], 1, mean, na.rm = TRUE)

tab <- select(.data = tab, PROVINCIA, AÑO, ARSENICO)
```
Comenzamos modificando los datos del primer fichero en este caso la variable es el arsénico


```{r}
##BENZOPIRENO
tabla2 <- select(.data = BaP_DD_2021, PROVINCIA, ANNO, D01:D31)

tabla2 <-rename(.data = tabla2, AÑO = ANNO)

tab2 <- tabla2 %>%
  group_by(PROVINCIA,AÑO) %>%
  summarise(across(c(D01:D31), ~ mean(.x, na.rm = TRUE)))

tab2$BENZOPIRENO <- apply(tab2[ ,c(3:33)], 1, mean, na.rm = TRUE)

tab2 <- select(.data = tab2, PROVINCIA, AÑO, BENZOPIRENO)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
